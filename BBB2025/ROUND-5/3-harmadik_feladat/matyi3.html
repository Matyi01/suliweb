<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>harmadik</title>
</head>

<body>


    <script>

        let adatok = {};

        const url = "https://bitkozpont.mik.uni-pannon.hu/2025/gettasks.php";
        fetch(url, {
            method: "POST",
            body: JSON.stringify({
                id: "3",
                teamcode: "f1e1ae76b73a8b7aa51b"
            }),
        })
            .then((response) => response.json())
            .then(function (json) {
                adatok = json;

                elso();

            });


        function elso() {

            console.log(adatok)



            let valasztomb = [];

            //egy pálya
            adatok.data.questions.forEach(e => {

                let matrix = [];

                let kesz = false;

                e.params.positions.forEach(pos1 => {
                    temp = [];

                    e.params.positions.forEach(pos2 => {
                        let tav = Math.ceil(Math.sqrt((pos1.x - pos2.x) * (pos1.x - pos2.x) + (pos1.y - pos2.y) * (pos1.y - pos2.y)))

                        temp.push(tav);

                        //matrix[pos1][pos2] = tav;
                    });
                    matrix.push(temp)
                });
                //megvan a matrix
                console.log(matrix);

                //bázis helye, itt kezd a hajó
                let base = {}
                e.params.positions.forEach(pos => {
                    if (pos.type == "Base") {
                        base = pos;
                    }
                });


                //bázis helyének indexe
                let baseindex = 0;
                for (let i = 0; i < e.params.positions.length; i++) {
                    if (e.params.positions[i].type == "Base") {
                        baseindex = i;
                    }
                }

                //hajó indexe
                let index = baseindex;

                
                console.log(base)
                console.log(e.params.positions)

                while (!kesz) {
                    let minInArray = Math.min(...matrix[index]);

                    let minIndex = matrix[index].indexOf(minInArray);
                    console.log("minindex: " + minIndex + " tav: " + minInArray);



                    kesz = true;
                }



                valasztomb.push({ id: e.ID, answer: matrix });
            });
            //console.log(valasztomb)

            const url = "https://bitkozpont.mik.uni-pannon.hu/2025/answer.php";
            fetch(url, {
                method: "POST",
                body: JSON.stringify({
                    id: adatok.data.ID,
                    teamcode: "f1e1ae76b73a8b7aa51b",
                    original_data: adatok.data,
                    original_hash: adatok.hash,
                    answer_data: valasztomb
                }),
            })
                .then((response) => response.json())
                .then(function (adatok) {
                    console.log(adatok)
                });


        }


    </script>
</body>

</html>